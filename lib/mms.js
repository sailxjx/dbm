// Generated by CoffeeScript 1.7.1
(function() {
  var MMS, colors, config, fs, mkdirp, path, util;

  fs = require('fs');

  path = require('path');

  util = require('util');

  mkdirp = require('mkdirp');

  colors = require('colors');

  config = require('./config');

  MMS = (function() {
    function MMS() {
      this._loadrc();
    }

    MMS.prototype._loadrc = function() {
      var e;
      try {
        return config = util._extend(config, require(path.resolve('./.mmsrc.json')));
      } catch (_error) {
        e = _error;
      }
    };

    MMS.prototype._loadMigrations = function() {};

    MMS.prototype.create = function(name, options, callback) {
      var downFile, ext, timestamp, upFile;
      if (options == null) {
        options = {};
      }
      if (callback == null) {
        callback = function() {};
      }
      timestamp = Date.now();
      ext = config.ext || '.js';
      upFile = path.join(config.dir, "" + timestamp + "_up_" + name + ext);
      downFile = path.join(config.dir, "" + timestamp + "_down_" + name + ext);
      mkdirp.sync(config.dir);
      fs.writeFileSync(upFile, '');
      console.log('  create up file:'.cyan, upFile.grey);
      fs.writeFileSync(downFile, '');
      console.log('  create down file:'.cyan, downFile.grey);
      return callback();
    };

    MMS.prototype.migrate = function(name, options, callback) {
      if (options == null) {
        options = {};
      }
      if (callback == null) {
        callback = function() {};
      }
    };

    MMS.prototype.rollback = function(name, options, callback) {
      if (options == null) {
        options = {};
      }
      if (callback == null) {
        callback = function() {};
      }
    };

    MMS.prototype.status = function(callback) {
      if (callback == null) {
        callback = function() {};
      }
    };

    return MMS;

  })();

  module.exports = new MMS;

}).call(this);
